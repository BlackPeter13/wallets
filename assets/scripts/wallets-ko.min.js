/*! Bitcoin and Altcoin Wallets 1.0.4 built on 02-12-2017 */
!function(a){"use strict";a(function(){function b(){var b=this;b.wallets={},b.coins=ko.observableArray(),b.selectedCoin=ko.observable(),b.users=ko.observableArray([]),b.moveCoin=ko.observable(),b.moveUser=ko.observable(),b.moveAmount=ko.observable(),b.moveComment=ko.observable(),b.currentPage=ko.observable(),b.rowsPerPage=ko.observable(10),b.withdrawAddress=ko.observable(),b.withdrawAmount=ko.observable(),b.withdrawComment=ko.observable(),b.withdrawCommentTo=ko.observable();var c=function(a,b,c){alert("Could not contact server.\nStatus: "+b+"\nError: "+c)},d=function(a){"string"==typeof a.result&&("error"==a.result?alert("Wallet operation failed: \n"+a.message):alert("Wallet operation failed due to unexpected error."))};b.getUsersInfo=function(){a.ajax({dataType:"json",async:!1,data:{__wallets_action:"get_users_info"},success:function(a){if("success"!=a.result)return void d(a);for(var c in a.users)b.users.push(a.users[c]);b.users().length&&b.moveUser(b.users()[0]),b.getCoinsInfo()},error:c})},b.getCoinsInfo=function(){a.ajax({dataType:"json",async:!1,data:{__wallets_action:"get_coins_info"},success:function(a){if("success"!=a.result)return void d(a);b.coins.removeAll();for(var c in a.coins)b.coins.push(a.coins[c]),b.wallets[c]={transactions:ko.observableArray(),balance_string:ko.observable(a.coins[c].balance_string),move_fee_string:ko.observable(a.coins[c].move_fee_string),withdraw_fee_string:ko.observable(a.coins[c].withdraw_fee_string),depositAddress:ko.observable(a.coins[c].deposit_address)};b.wallets.length&&b.selectedCoin(b.coins()[0])},error:c})},b.getTransactions=function(){var e=parseInt(b.currentPage()),f=b.rowsPerPage(),g=(e-1)*f,h=b.selectedCoin();"undefined"!=typeof b.wallets[h]&&a.ajax({dataType:"json",data:{__wallets_action:"get_transactions",__wallets_tx_count:f,__wallets_tx_from:g,__wallets_symbol:h},success:function(a){return"success"!=a.result?void d(a):void(!a.transactions.length&&e>1?b.currentPage(e-1):b.wallets[h].transactions(a.transactions))},error:c})},b.selectedCoin.subscribe(b.getTransactions),b.currentPage.subscribe(b.getTransactions),b.rowsPerPage.subscribe(b.getTransactions),b.doWithdraw=function(d){var e=b.withdrawAddress(),f=b.selectedCoin(),g=b.withdrawAmount(),h=b.withdrawComment(),i=b.withdrawCommentTo(),j=a("input[name=_wpnonce]",d).val();a.ajax({dataType:"json",data:{__wallets_action:"do_withdraw",__wallets_withdraw_address:e,__wallets_symbol:f,__wallets_withdraw_amount:g,__wallets_withdraw_comment:h,__wallets_withdraw_comment_to:i,_wpnonce:j},success:function(b){a(d).trigger("wallets_do_withdraw",[b,f,g,e,h,i])},error:c})},b.doMove=function(d){var e=b.moveUser().id,f=b.moveAmount(),g=b.moveComment(),h=b.selectedCoin(),i=a("input[name=_wpnonce]",d).val();a.ajax({dataType:"json",data:{__wallets_action:"do_move",__wallets_move_toaccount:e,__wallets_move_amount:f,__wallets_move_comment:g,__wallets_symbol:h,_wpnonce:i},success:function(b){a(d).trigger("wallets_do_move",[b,h,f,e,g])},error:c})},a("html").on("wallets_do_move wallets_do_withdraw",function(a,c){"success"!=c.result?(d(c),a.preventDefault()):(b.getTransactions(),a.target.reset())}),a("html").on("wallets_do_move",function(a,b,c,d,e,f){"success"==b.result&&alert("Successfully sent "+d+" "+c)}),a("html").on("wallets_do_withdraw",function(a,b,c,d,e,f,g){"success"==b.result&&alert("Successfully withdrew "+d+" "+c+" to "+e)})}var c=new b;c.getUsersInfo(),ko.applyBindings(c),c.currentPage(1)})}(jQuery);